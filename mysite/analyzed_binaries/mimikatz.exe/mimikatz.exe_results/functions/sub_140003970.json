{
  "address": "0x140003970",
  "rules": [
    "check for time delay via GetTickCount/dcdc41ab318e4e618f624ba5aeac30b2",
    "initialize hashing via WinCrypt",
    "hash data via WinCrypt/e7b500967c6340beaa50c0acc9342c6e",
    "write file on Windows/035d57bed47747649158312e9532f27d",
    "hash data via WinCrypt",
    "connect to WMI namespace via WbemLocator/50f8c95bd151440fa4fe29260efaf440",
    "create new key via CryptAcquireContext"
  ],
  "disassembly": [
    "mov     qword [rsp+0x10], rbx",
    "mov     qword [rsp+0x18], rbp",
    "push    rsi",
    "push    rdi",
    "push    r12",
    "sub     rsp, 0x50",
    "xor     ebx, ebx",
    "mov     r12, r9",
    "mov     esi, r8d",
    "mov     rbp, rdx",
    "mov     edi, ecx",
    "cmp     ecx, 0x8000",
    "jne     0x140003a0c",
    "lea     rcx, [rsp+0x48]",
    "mov     r9d, 0x18",
    "xor     r8d, r8d",
    "xor     edx, edx",
    "mov     dword [rsp+0x20], 0xf0000000",
    "call    qword [rel CryptAcquireContextW]",
    "cmp     eax, ebx",
    "je      0x140003aff",
    "cmp     dword [rsp+0x90], 0x4",
    "jne     0x140003aff",
    "lea     r11, [rsp+0x50]",
    "mov     eax, ebx",
    "mov     rbx, qword [r11+0x28]",
    "mov     rbp, qword [r11+0x30]",
    "mov     rsp, r11",
    "pop     r12",
    "pop     rdi",
    "pop     rsi",
    "retn    ",
    "mov     rcx, qword [rsp+0x48]",
    "lea     rax, [rsp+0x38]",
    "xor     r9d, r9d",
    "xor     r8d, r8d",
    "mov     edx, edi",
    "mov     qword [rsp+0x20], rax",
    "call    qword [rel CryptCreateHash]",
    "cmp     eax, ebx",
    "je      0x140003af2",
    "lea     rdx, [rsp+0x30]",
    "mov     ecx, 0xffffff7c",
    "call    CDLocateCheckSum",
    "cmp     eax, ebx",
    "jl      0x140003aff",
    "mov     rcx, qword [rsp+0x48]",
    "xor     edx, edx",
    "call    qword [rel CryptReleaseContext]",
    "mov     rcx, qword [rsp+0x38]",
    "xor     r9d, r9d",
    "mov     r8d, esi",
    "mov     rdx, rbp",
    "call    qword [rel CryptHashData]",
    "cmp     eax, ebx",
    "je      0x140003ae7",
    "mov     rax, qword [rsp+0x30]",
    "lea     rdx, [rsp+0x40]",
    "xor     ecx, ecx",
    "call    qword [rax+0x10]",
    "cmp     eax, ebx",
    "jl      0x140003aff",
    "mov     rcx, qword [rsp+0x38]",
    "call    qword [rel CryptDestroyHash]",
    "mov     rcx, qword [rsp+0x38]",
    "xor     r8d, r8d",
    "lea     r9, [rsp+0x70]",
    "lea     esi, [r8+0x2]",
    "mov     dword [rsp+0x20], ebx",
    "mov     edx, esi",
    "call    qword [rel CryptGetHashParam]",
    "cmp     eax, ebx",
    "je      0x140003ae7",
    "mov     rax, qword [rsp+0x30]",
    "mov     rcx, qword [rsp+0x40]",
    "mov     r8, rbp",
    "mov     edx, esi",
    "call    qword [rax+0x18]",
    "mov     rax, qword [rsp+0x30]",
    "mov     rcx, qword [rsp+0x40]",
    "mov     rdx, r12",
    "call    qword [rax+0x20]",
    "lea     rcx, [rsp+0x40]",
    "cmp     eax, ebx",
    "mov     rax, qword [rsp+0x30]",
    "setge   bl",
    "call    qword [rax+0x28]",
    "jmp     0x140003aff",
    "mov     edx, dword [rsp+0x70]",
    "lea     ecx, [rsi+0x3e]",
    "call    qword [rel LocalAlloc]",
    "mov     rdi, rax",
    "cmp     rax, rbx",
    "je      0x140003ae7",
    "mov     rcx, qword [rsp+0x38]",
    "lea     r9, [rsp+0x70]",
    "mov     r8, rax",
    "mov     edx, esi",
    "mov     dword [rsp+0x20], ebx",
    "call    qword [rel CryptGetHashParam]",
    "mov     ecx, dword [rsp+0x90]",
    "mov     rdx, rdi",
    "cmp     dword [rsp+0x70], ecx",
    "mov     ebx, eax",
    "cmovb   ecx, dword [rsp+0x70]",
    "mov     r8d, ecx",
    "mov     rcx, r12",
    "call    memcpy",
    "mov     rcx, rdi",
    "call    qword [rel LocalFree]"
  ],
  "high_level_IL": [
    "No High Level IL Loaded"
  ]
}