{
  "address": "0x1400b00d0",
  "rules": [
    "check for time delay via GetTickCount/dcdc41ab318e4e618f624ba5aeac30b2",
    "connect to WMI namespace via WbemLocator/50f8c95bd151440fa4fe29260efaf440",
    "contain loop",
    "validate payment card number using luhn algorithm with no lookup table/f595b07566ee46b3ba7870816078c34e"
  ],
  "disassembly": [
    "mov     r11, rsp {__return_addr}",
    "mov     qword [r11+0x8 {__saved_rsi}], rsi",
    "push    rdi {__saved_rdi}",
    "push    r12 {__saved_r12}",
    "push    r14 {__saved_r14}",
    "sub     rsp, 0xb0",
    "mov     rsi, rdx",
    "mov     r12d, ecx",
    "mov     edi, 0x57",
    "and     dword [r11-0x28 {var_28}], 0x0",
    "xor     eax, eax  {0x0}",
    "mov     dword [r11-0x24 {var_24}], eax  {0x0}",
    "mov     dword [r11-0x20 {var_20}], eax  {0x0}",
    "mov     dword [r11-0x1c {var_1c}], eax  {0x0}",
    "cmp     qword [rel data_140140750], rax",
    "jne     0x1400b0409  {data_140140750}",
    "lea     rcx, [rel data_14011db90]  {u\"ERROR kuhl_m_rpc_connect ; Alrea\u2026\"}",
    "call    sub_14000c030",
    "mov     dword [rsp+0x60 {var_68_1}], 0x1",
    "lea     rax, [rel data_14013f694]",
    "mov     qword [r11-0x70 {var_70_1}], rax  {data_14013f694}",
    "and     qword [r11-0x78 {var_78}], 0x0",
    "lea     rax, [r11+0x18 {arg_18}]",
    "mov     qword [r11-0x80 {var_80_1}], rax {arg_18}",
    "mov     dword [rsp+0x40 {var_88}], 0x9",
    "lea     rax, [r11+0x20 {arg_20}]",
    "mov     qword [rsp+0x38 {var_90_1}], rax {arg_20}",
    "and     qword [rsp+0x30 {var_98_1}], 0x0",
    "lea     rax, [r11-0x48 {var_48}]",
    "mov     qword [rsp+0x28 {var_a0_1}], rax {var_48}",
    "lea     rax, [r11-0x40 {var_40}]",
    "mov     qword [rsp+0x20 {var_a8_1}], rax {var_40}",
    "lea     r9, [r11-0x30 {var_30}]",
    "lea     r8, [r11-0x38 {var_38}]",
    "call    sub_140010594",
    "lea     r11, [rel data_1400e2970]  {u\"3DES\"}",
    "mov     qword [rsp+0x20 {var_a8}], r11  {data_1400e2970, u\"3DES\"}",
    "lea     r9, [rsp+0x78 {string1}]",
    "lea     r8, [rel data_14011d658]",
    "mov     rdx, rsi",
    "mov     ecx, r12d",
    "call    sub_140013220",
    "cmp     qword [rsp+0x78 {string1}], 0x0",
    "je      0x1400b01de",
    "xor     esi, esi  {0x0}",
    "xor     esi, esi  {0x0}",
    "lea     r14, [rel data_1400dfba0]",
    "mov     r12, r14  {data_1400dfba0}",
    "test    edi, edi",
    "je      0x1400b0415",
    "lea     rdx, [rel data_14013f690]",
    "mov     rcx, qword [rel data_140140750]",
    "call    qword [rel RpcEpResolveBinding]",
    "mov     edi, eax",
    "test    eax, eax",
    "jne     0x1400b03c2",
    "mov     eax, esi",
    "add     rax, rax",
    "mov     esi, dword [r14+rax*8+0x8]",
    "jmp     0x1400b01e0",
    "mov     rdx, qword [r12]",
    "add     rdx, 0xa",
    "mov     rcx, qword [rsp+0x78 {string1}]",
    "call    qword [rel _wcsicmp]",
    "test    eax, eax",
    "je      0x1400b01d2",
    "xor     eax, eax  {0x0}",
    "mov     rsi, qword [rsp+0xd0 {__saved_rsi}]",
    "add     rsp, 0xb0",
    "pop     r14 {__saved_r14}",
    "pop     r12 {__saved_r12}",
    "pop     rdi {__saved_rdi}",
    "retn     {__return_addr}",
    "xor     edx, edx  {0x0}",
    "xor     ecx, ecx  {0x0}",
    "call    sub_1400af93c",
    "jmp     0x1400b0415",
    "cmp     eax, 0x6d9",
    "jne     0x1400b03d7",
    "lea     rcx, [rel data_14011d690]  {u\"Endpoint resolution is OK\\n\"}",
    "call    sub_14000c030",
    "mov     edi, 0x6c6",
    "mov     dword [rsp+0x70 {var_58_1}], edi  {0x6c6}",
    "mov     ecx, esi",
    "call    sub_140005720",
    "mov     qword [rel data_140140760], rax",
    "test    rax, rax",
    "je      0x1400b03ac",
    "test    esi, 0x6000",
    "mov     eax, 0x6603",
    "cmove   esi, eax  {0x6603}",
    "mov     ecx, esi",
    "call    sub_140005694",
    "mov     rdx, rax",
    "mov     r8d, esi",
    "lea     rcx, [rel data_14011d660]  {u\"Algorithm: %s (%08x)\\n\"}",
    "call    sub_14000c030",
    "mov     r11d, dword [rsp+0xe0 {arg_18}]",
    "lea     rcx, [rel data_1400df898]",
    "neg     r11d",
    "sbb     rax, rax",
    "and     rax, rcx",
    "and     qword [rsp+0x50 {var_78_1}], 0x0",
    "lea     rcx, [rel data_140140750]",
    "mov     qword [rsp+0x48 {var_80}], rcx  {data_140140750}",
    "and     dword [rsp+0x40 {var_88}], 0x0",
    "mov     qword [rsp+0x38 {var_90_2}], rax",
    "mov     eax, dword [rsp+0xe8 {arg_20}]",
    "mov     dword [rsp+0x30 {var_98_1}], eax",
    "and     dword [rsp+0x28 {var_a0_1}], 0x0",
    "mov     rax, qword [rsp+0x80 {var_48}]",
    "mov     qword [rsp+0x20 {var_a8_2}], rax",
    "mov     r9, qword [rsp+0x88 {var_40}]",
    "mov     r8, qword [rsp+0x90 {var_38}]",
    "mov     rdx, qword [rsp+0x98 {var_30}]",
    "xor     ecx, ecx  {0x0}",
    "call    sub_140010274",
    "test    eax, eax",
    "je      0x1400b03fa",
    "inc     esi",
    "add     r12, 0x10",
    "cmp     esi, 0x2e",
    "jb      0x1400b019b",
    "cmp     eax, 0x6ba",
    "jne     0x1400b03ec",
    "lea     rcx, [rel data_14011dab0]  {u\"ERROR kuhl_m_rpc_connect ; Endpo\u2026\"}",
    "call    sub_14000c030",
    "jmp     0x1400b03fa",
    "call    qword [rel GetLastError]",
    "mov     edx, eax",
    "lea     rcx, [rel data_14011da30]  {u\"ERROR kuhl_m_rpc_connect ; kull_\u2026\"}",
    "call    sub_14000c030",
    "jmp     0x1400b03fa",
    "lea     r9, [rax+0x10]",
    "lea     rax, [rel data_140140758]",
    "mov     qword [rsp+0x28 {var_a0}], rax  {data_140140758}",
    "lea     rax, [rsp+0xa0 {var_28}]",
    "mov     qword [rsp+0x20 {var_a8_3}], rax {var_28}",
    "mov     r8, qword [rel data_140140750]",
    "lea     rdx, [rel data_1400df2d2]",
    "lea     rcx, [rel data_1400df3f0]",
    "call    NdrClientCall2",
    "test    eax, eax",
    "js      0x1400b0346",
    "mov     rdx, qword [r12]",
    "mov     rcx, qword [rsp+0x78 {string1}]",
    "call    qword [rel _wcsicmp]",
    "test    eax, eax",
    "je      0x1400b01d2",
    "jmp     0x1400b01de",
    "mov     edx, eax",
    "lea     rcx, [rel data_14011db20]  {u\"ERROR kuhl_m_rpc_connect ; RpcEp\u2026\"}",
    "call    sub_14000c030",
    "lea     rcx, [rel data_14011d950]  {u\"ERROR kuhl_m_rpc_connect ; RPC S\u2026\"}",
    "call    sub_14000c030",
    "jmp     0x1400b03fa",
    "mov     edx, eax",
    "lea     rcx, [rel data_14011d780]  {u\"ERROR kuhl_m_rpc_connect ; CLI_M\u2026\"}",
    "call    sub_14000c030",
    "lea     rcx, [rel data_14011d6c8]  {u\"mimikatz is bound!\\n\"}",
    "call    sub_14000c030",
    "lea     rdx, [rsp+0xa0 {var_28}]",
    "mov     rcx, qword [rel data_140140760]",
    "call    sub_140005868",
    "test    eax, eax",
    "je      0x1400b0330",
    "jmp     0x1400b03fa",
    "call    qword [rel GetLastError]",
    "mov     edx, eax",
    "lea     rcx, [rel data_14011d6f0]  {u\"ERROR kuhl_m_rpc_connect ; kull_\u2026\"}",
    "call    sub_14000c030",
    "jmp     0x1400b0354",
    "xor     edi, edi  {0x0}",
    "mov     dword [rsp+0x70 {var_58_2}], edi  {0x0}",
    "jmp     0x1400b0354",
    "jmp     0x1400b03aa"
  ],
  "high_level_IL": [
    "int32_t rdi = 0x57",
    "int32_t var_28 = 0",
    "int32_t var_24 = 0",
    "int32_t var_20 = 0",
    "int32_t var_1c = 0",
    "if (data_140140750 != 0)",
    "sub_14000c030(u\"ERROR kuhl_m_rpc_connect ; Alrea\u2026\", arg2)",
    "int32_t var_68_1 = 1",
    "void* var_70_1 = &data_14013f694",
    "int64_t var_98_1 = 0",
    "int64_t var_48",
    "void* var_40",
    "void* var_38",
    "int64_t var_30",
    "sub_140010594(arg1, arg2, &var_38, &var_30, &var_40, &var_48, nullptr, &arg_20, 9, &arg_18, nullptr)",
    "wchar16* string1",
    "sub_140013220(arg1, arg2, u\"alg\", &string1, u\"3DES\")",
    "int32_t rsi_2",
    "if (string1 == 0)",
    "label_1400b01de:",
    "rsi_2 = 0",
    "int32_t rsi_1 = 0",
    "wchar16 const (** const r12_1)[0x9] = &data_1400dfba0",
    "while (true)",
    "if (_wcsicmp(string1, *r12_1) != 0 && _wcsicmp(string1, &(**r12_1)[5]) != 0)",
    "rsi_1 += 1",
    "r12_1 = &r12_1[2]",
    "if (rsi_1 u>= 0x2e)",
    "goto label_1400b01de",
    "continue",
    "rsi_2 = *(zx.q(rsi_1) * 0x10 + &data_1400dfba8)",
    "break",
    "if ((rsi_2 & 0x6000) == 0)",
    "rsi_2 = 0x6603",
    "int64_t rax_6 = sub_14000c030(u\"Algorithm: %s (%08x)\\n\", sub_140005694(rsi_2))",
    "int64_t var_78_1 = 0",
    "var_98_1.d = arg_20",
    "void* var_a0_1",
    "var_a0_1.d = 0",
    "if (sub_140010274(0, var_30, var_38, var_40, var_48.d, var_a0_1.d, var_98_1, (sbb.q(rax_6, rax_6, arg_18 != 0)).d & 0x400df898, nullptr, &data_140140750) != 0)",
    "int32_t rax_12",
    "int64_t rdx_6",
    "rax_12, rdx_6 = RpcEpResolveBinding(data_140140750, &data_14013f690)",
    "rdi = rax_12",
    "if (rax_12 == 0)",
    "sub_14000c030(u\"Endpoint resolution is OK\\n\", rdx_6)",
    "rdi = 0x6c6",
    "int32_t var_58_1 = 0x6c6",
    "HLOCAL rax_13 = sub_140005720(rsi_2)",
    "data_140140760 = rax_13",
    "if (rax_13 == 0)",
    "sub_14000c030(u\"ERROR kuhl_m_rpc_connect ; kull_\u2026\", zx.q(GetLastError()))",
    "int32_t rax_14",
    "int64_t rdx_7",
    "rax_14, rdx_7 = NdrClientCall2(&data_1400df3f0, &data_1400df2d2, data_140140750, rax_13 + 0x10, &var_28, &data_140140758)",
    "if (rax_14 s< 0)",
    "sub_14000c030(u\"ERROR kuhl_m_rpc_connect ; CLI_M\u2026\", zx.q(rax_14))",
    "sub_14000c030(u\"mimikatz is bound!\\n\", rdx_7)",
    "if (sub_140005868(data_140140760, &var_28) == 0)",
    "sub_14000c030(u\"ERROR kuhl_m_rpc_connect ; kull_\u2026\", zx.q(GetLastError()))",
    "rdi = 0",
    "int32_t var_58_2 = 0",
    "if (rax_12 == 0x6d9)",
    "sub_14000c030(u\"ERROR kuhl_m_rpc_connect ; Endpo\u2026\", rdx_6)",
    "if (rax_12 != 0x6ba)",
    "sub_14000c030(u\"ERROR kuhl_m_rpc_connect ; RpcEp\u2026\", zx.q(rax_12))",
    "sub_14000c030(u\"ERROR kuhl_m_rpc_connect ; RPC S\u2026\", rdx_6)",
    "if (rdi != 0)",
    "sub_1400af93c()",
    "return 0"
  ]
}