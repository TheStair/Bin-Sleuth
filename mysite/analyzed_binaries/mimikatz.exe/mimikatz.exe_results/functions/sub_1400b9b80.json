{
  "address": "0x1400b9b80",
  "rules": [
    "connect to WMI namespace via WbemLocator/50f8c95bd151440fa4fe29260efaf440",
    "write file on Windows/035d57bed47747649158312e9532f27d",
    "allocate or change RWX memory/e5d60c23edee4683a25ac882b99be25c/be08ffa5ddd942e8ab0706a663121e4b"
  ],
  "disassembly": [
    "mov     r11, rsp {__return_addr}",
    "mov     qword [r11+0x10 {__saved_rbx}], rbx",
    "mov     qword [r11+0x18 {__saved_rsi}], rsi",
    "push    rdi {__saved_rdi}",
    "sub     rsp, 0x80",
    "and     qword [r11-0x18 {var_18}], 0x0",
    "and     qword [r11+0x8 {arg_8}], 0x0",
    "lea     rax, [rel data_1400eb780]  {u\"rootDomainNamingContext\"}",
    "mov     qword [r11-0x48 {var_48}], rax  {data_1400eb780, u\"rootDomainNamingContext\"}",
    "lea     rax, [rel data_1401266e8]  {u\"configurationNamingContext\"}",
    "mov     rbx, rcx",
    "mov     rcx, qword [rcx+0xd0]",
    "mov     qword [r11-0x40 {var_40}], rax  {data_1401266e8, u\"configurationNamingContext\"}",
    "lea     rax, [rel data_140124438]  {u\"schemaNamingContext\"}",
    "mov     qword [r11-0x38 {var_38}], rax  {data_140124438, u\"schemaNamingContext\"}",
    "lea     rax, [rel data_140126720]  {u\"dsServiceName\"}",
    "xor     r9d, r9d  {0x0}",
    "mov     qword [r11-0x30 {var_30}], rax  {data_140126720, u\"dsServiceName\"}",
    "lea     rax, [rel data_140126740]  {u\"domainControllerFunctionality\"}",
    "xor     r8d, r8d  {0x0}",
    "mov     qword [r11-0x28 {var_28}], rax  {data_140126740, u\"domainControllerFunctionality\"}",
    "lea     rax, [rel data_140126780]  {u\"highestCommittedUSN\"}",
    "xor     edx, edx  {0x0}",
    "mov     qword [r11-0x20 {var_20}], rax  {data_140126780, u\"highestCommittedUSN\"}",
    "lea     rax, [r11+0x8 {arg_8}]",
    "mov     qword [r11-0x58 {var_58}], rax {arg_8}",
    "and     dword [rsp+0x28 {var_60}], 0x0",
    "lea     rax, [r11-0x48 {var_48}]",
    "mov     qword [r11-0x68 {var_68}], rax {var_48}",
    "call    qword [rel Ordinal_WLDAP32_208]",
    "test    eax, eax",
    "jne     0x1400b9e90",
    "lea     rcx, [rel data_140126990]  {u\"ERROR kuhl_m_lsadump_dcshadow_do\u2026\"}",
    "mov     r8d, eax",
    "mov     edx, eax",
    "call    sub_14000c030",
    "mov     rdx, qword [rsp+0x90 {arg_8}]",
    "mov     rcx, qword [rbx+0xd0]",
    "call    qword [rel Ordinal_WLDAP32_36]",
    "mov     esi, 0x1",
    "cmp     eax, esi",
    "jne     0x1400b9e58",
    "lea     rcx, [rel data_1401268f0]  {u\"ERROR kuhl_m_lsadump_dcshadow_do\u2026\"}",
    "call    sub_14000c030",
    "mov     r8, qword [rsp+0x40 {var_48}]",
    "mov     rdx, qword [rsp+0x90 {arg_8}]",
    "mov     rcx, qword [rbx+0xd0]",
    "call    qword [rel Ordinal_WLDAP32_140]",
    "test    rax, rax",
    "je      0x1400b9c5f",
    "xor     esi, esi  {0x0}",
    "cmp     qword [rbx+0x30], 0x0",
    "je      0x1400b9ea1",
    "xor     eax, eax  {0x0}",
    "mov     rcx, rax",
    "call    sub_1400b9184",
    "jmp     0x1400b9c61",
    "cmp     qword [rbx+0x38], 0x0",
    "je      0x1400b9ea1",
    "mov     r8, qword [rsp+0x48 {var_40}]",
    "mov     rdx, qword [rsp+0x90 {arg_8}]",
    "mov     rcx, qword [rbx+0xd0]",
    "call    qword [rel Ordinal_WLDAP32_140]",
    "test    rax, rax",
    "je      0x1400b9ca2",
    "lea     rcx, [rel data_1401267a8]  {u\"Domain:         %s\\n\"}",
    "mov     rdx, rax",
    "call    sub_14000c030",
    "mov     qword [rbx+0x28], rax",
    "test    rax, rax",
    "je      0x1400b9c79",
    "cmp     qword [rbx+0x40], 0x0",
    "je      0x1400b9ea1",
    "xor     eax, eax  {0x0}",
    "mov     rcx, rax",
    "call    sub_1400b9184",
    "jmp     0x1400b9ca4",
    "jmp     0x1400b9ea3",
    "mov     r8, qword [rsp+0x50 {var_38}]",
    "mov     rdx, qword [rsp+0x90 {arg_8}]",
    "mov     rcx, qword [rbx+0xd0]",
    "call    qword [rel Ordinal_WLDAP32_140]",
    "test    rax, rax",
    "je      0x1400b9ce5",
    "lea     rcx, [rel data_1401267d0]  {u\"Configuration:  %s\\n\"}",
    "mov     rdx, rax",
    "call    sub_14000c030",
    "mov     qword [rbx+0x30], rax",
    "test    rax, rax",
    "je      0x1400b9cbc",
    "lea     r11, [rsp+0x80 {__saved_rdi}]",
    "mov     eax, esi",
    "mov     rbx, qword [r11+0x18 {__saved_rbx}]",
    "mov     rsi, qword [r11+0x20 {__saved_rsi}]",
    "mov     rsp, r11",
    "pop     rdi {__saved_rdi}",
    "retn     {__return_addr}",
    "xor     eax, eax  {0x0}",
    "mov     rcx, rax",
    "call    sub_1400b9184",
    "jmp     0x1400b9ce7",
    "mov     r8, qword [rsp+0x58 {var_30}]",
    "mov     rdx, qword [rsp+0x90 {arg_8}]",
    "mov     rcx, qword [rbx+0xd0]",
    "call    qword [rel Ordinal_WLDAP32_140]",
    "test    rax, rax",
    "je      0x1400b9d28",
    "lea     rcx, [rel data_1401267f8]  {u\"Schema:         %s\\n\"}",
    "mov     rdx, rax",
    "call    sub_14000c030",
    "mov     qword [rbx+0x38], rax",
    "test    rax, rax",
    "je      0x1400b9cff",
    "xor     eax, eax  {0x0}",
    "mov     rcx, rax",
    "call    sub_1400b9184",
    "jmp     0x1400b9d2a",
    "mov     r8, qword [rsp+0x60 {var_28}]",
    "mov     rdx, qword [rsp+0x90 {arg_8}]",
    "mov     rcx, qword [rbx+0xd0]",
    "call    qword [rel Ordinal_WLDAP32_140]",
    "test    rax, rax",
    "je      0x1400b9daf",
    "lea     rdx, [rel data_140126820]  {u\",CN=\"}",
    "mov     rcx, rax",
    "call    qword [rel wcsstr]",
    "test    rax, rax",
    "je      0x1400b9d83",
    "mov     qword [rbx+0x48], rax",
    "test    rax, rax",
    "je      0x1400b9d83",
    "xor     edi, edi  {0x0}",
    "mov     rcx, rax",
    "call    sub_1400b9184",
    "mov     rdi, rax",
    "jmp     0x1400b9db1",
    "lea     rcx, [rax+0x2]",
    "lea     rdx, [rel data_140126820]  {u\",CN=\"}",
    "call    qword [rel wcsstr]",
    "test    rax, rax",
    "je      0x1400b9d73",
    "mov     edx, dword [rbx+0x50]",
    "cmp     edx, 0x8",
    "jae     0x1400b9de6",
    "xor     edx, edx  {0x0}",
    "mov     rcx, rdi",
    "lea     r8d, [rdx+0xa]",
    "call    qword [rel wcstoul]",
    "mov     rcx, rdi",
    "mov     dword [rbx+0x50], eax",
    "call    qword [rel LocalFree]",
    "test    rdi, rdi",
    "je      0x1400b9dd1",
    "mov     rdx, qword [rbx+0x40]",
    "lea     rcx, [rel data_140126830]  {u\"dsServiceName:  %s\\n\"}",
    "call    sub_14000c030",
    "lea     rcx, [rax+0x2]",
    "test    rcx, rcx",
    "je      0x1400b9d73",
    "lea     r8, [rel data_1400e17c8]",
    "lea     r8, [rel data_1400d4190]",
    "mov     r8, qword [r8+rdx*8]",
    "jmp     0x1400b9ded",
    "lea     rcx, [rbx+0x40]",
    "mov     rdx, rax",
    "call    sub_1400134d4",
    "xor     edi, edi  {0x0}",
    "mov     rcx, rax",
    "call    sub_1400b9184",
    "mov     rdi, rax",
    "jmp     0x1400b9e27",
    "lea     rcx, [rel data_140126860]  {u\"domainControllerFunctionality: %\u2026\"}",
    "call    sub_14000c030",
    "mov     r8, qword [rsp+0x68 {var_20}]",
    "mov     rdx, qword [rsp+0x90 {arg_8}]",
    "mov     rcx, qword [rbx+0xd0]",
    "call    qword [rel Ordinal_WLDAP32_140]",
    "test    rax, rax",
    "je      0x1400b9e25",
    "mov     edx, dword [rbx+0x58]",
    "lea     rcx, [rel data_1401268b8]  {u\"highestCommittedUSN: %u\\n\"}",
    "call    sub_14000c030",
    "jmp     0x1400b9e64",
    "xor     edx, edx  {0x0}",
    "mov     rcx, rdi",
    "lea     r8d, [rdx+0xa]",
    "call    qword [rel wcstoul]",
    "mov     rcx, rdi",
    "mov     dword [rbx+0x58], eax",
    "call    qword [rel LocalFree]",
    "test    rdi, rdi",
    "je      0x1400b9e47",
    "mov     rcx, qword [rsp+0x90 {arg_8}]",
    "call    qword [rel Ordinal_WLDAP32_41]",
    "cmp     qword [rbx+0x28], 0x0",
    "je      0x1400b9ea1"
  ],
  "high_level_IL": [
    "int64_t var_18 = 0",
    "arg_8 = 0",
    "wchar16 const* const var_48 = u\"rootDomainNamingContext\"",
    "wchar16 const* const var_40 = u\"configurationNamingContext\"",
    "wchar16 const* const var_38 = u\"schemaNamingContext\"",
    "wchar16 const* const var_30 = u\"dsServiceName\"",
    "wchar16 const* const var_28 = u\"domainControllerFunctionality\"",
    "wchar16 const* const var_20 = u\"highestCommittedUSN\"",
    "int32_t rax = Ordinal_WLDAP32_208(*(arg1 + 0xd0), 0, 0, 0, &var_48, 0, &arg_8)",
    "int32_t rsi_1",
    "if (rax != 0)",
    "sub_14000c030(u\"ERROR kuhl_m_lsadump_dcshadow_do\u2026\", zx.q(rax))",
    "rsi_1 = 0",
    "int32_t rax_1",
    "int64_t rdx_1",
    "rax_1, rdx_1 = Ordinal_WLDAP32_36(*(arg1 + 0xd0), arg_8)",
    "rsi_1 = 1",
    "if (rax_1 != 1)",
    "sub_14000c030(u\"ERROR kuhl_m_lsadump_dcshadow_do\u2026\", rdx_1)",
    "int64_t rax_2 = Ordinal_WLDAP32_140(*(arg1 + 0xd0), arg_8, var_48)",
    "int64_t rax_3",
    "if (rax_2 == 0)",
    "rax_3 = 0",
    "rax_3 = sub_1400b9184(rax_2)",
    "*(arg1 + 0x28) = rax_3",
    "if (rax_3 != 0)",
    "sub_14000c030(u\"Domain:         %s\\n\", rax_3)",
    "int64_t rax_4 = Ordinal_WLDAP32_140(*(arg1 + 0xd0), arg_8, var_40)",
    "int64_t rax_5",
    "if (rax_4 == 0)",
    "rax_5 = 0",
    "rax_5 = sub_1400b9184(rax_4)",
    "*(arg1 + 0x30) = rax_5",
    "if (rax_5 != 0)",
    "sub_14000c030(u\"Configuration:  %s\\n\", rax_5)",
    "int64_t rax_6 = Ordinal_WLDAP32_140(*(arg1 + 0xd0), arg_8, var_38)",
    "int64_t rax_7",
    "if (rax_6 == 0)",
    "rax_7 = 0",
    "rax_7 = sub_1400b9184(rax_6)",
    "*(arg1 + 0x38) = rax_7",
    "if (rax_7 != 0)",
    "sub_14000c030(u\"Schema:         %s\\n\", rax_7)",
    "int64_t rax_8 = Ordinal_WLDAP32_140(*(arg1 + 0xd0), arg_8, var_30)",
    "wchar16* ws",
    "if (rax_8 == 0)",
    "ws = nullptr",
    "ws = sub_1400b9184(rax_8)",
    "*(arg1 + 0x48) = ws",
    "if (ws != 0)",
    "wchar16* rax_9 = wcsstr(ws, u\",CN=\")",
    "if (rax_9 != 0)",
    "wchar16* rax_10 = wcsstr(&rax_9[1], u\",CN=\")",
    "if (rax_10 != 0 && rax_10 != -2)",
    "sub_1400134d4(arg1 + 0x40, rax_10)",
    "sub_14000c030(u\"dsServiceName:  %s\\n\", *(arg1 + 0x40))",
    "int64_t rax_11 = Ordinal_WLDAP32_140(*(arg1 + 0xd0), arg_8, var_28)",
    "HLOCAL rdi_1",
    "if (rax_11 == 0)",
    "rdi_1 = nullptr",
    "rdi_1 = sub_1400b9184(rax_11)",
    "if (rdi_1 != 0)",
    "*(arg1 + 0x50) = wcstoul(rdi_1, nullptr, 0xa)",
    "LocalFree(rdi_1)",
    "uint64_t rdx_12 = zx.q(*(arg1 + 0x50))",
    "if (rdx_12.d u< 8)",
    "(&data_1400d4190)[rdx_12]",
    "sub_14000c030(u\"domainControllerFunctionality: %\u2026\", rdx_12)",
    "int64_t rax_14 = Ordinal_WLDAP32_140(*(arg1 + 0xd0), arg_8, var_20)",
    "HLOCAL rdi_2",
    "if (rax_14 == 0)",
    "rdi_2 = nullptr",
    "rdi_2 = sub_1400b9184(rax_14)",
    "if (rdi_2 != 0)",
    "*(arg1 + 0x58) = wcstoul(rdi_2, nullptr, 0xa)",
    "LocalFree(rdi_2)",
    "sub_14000c030(u\"highestCommittedUSN: %u\\n\", zx.q(*(arg1 + 0x58)))",
    "Ordinal_WLDAP32_41(arg_8)",
    "if (*(arg1 + 0x28) == 0 || *(arg1 + 0x30) == 0 || *(arg1 + 0x38) == 0 || *(arg1 + 0x40) == 0)",
    "rsi_1 = 0",
    "return zx.q(rsi_1)"
  ]
}