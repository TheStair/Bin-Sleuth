{
  "address": "0x14009ee64",
  "rules": [
    "write file on Windows/035d57bed47747649158312e9532f27d",
    "check for time delay via GetTickCount/dcdc41ab318e4e618f624ba5aeac30b2",
    "connect to WMI namespace via WbemLocator/50f8c95bd151440fa4fe29260efaf440",
    "create or open file",
    "validate payment card number using luhn algorithm with no lookup table/f595b07566ee46b3ba7870816078c34e"
  ],
  "disassembly": [
    "mov     rax, rsp",
    "mov     dword [rax+0x18], r8d",
    "mov     qword [rax+0x10], rdx",
    "mov     dword [rax+0x8], ecx",
    "push    rbx",
    "push    rsi",
    "push    rdi",
    "push    r12",
    "push    r13",
    "push    r14",
    "push    r15",
    "sub     rsp, 0xe0",
    "mov     r15d, r8d",
    "mov     r12, rdx",
    "mov     r13d, ecx",
    "xor     ebx, ebx",
    "mov     qword [rax-0x70], rbx",
    "mov     qword [rax-0x68], rbx",
    "mov     qword [rsp+0x60], rbx",
    "xor     edx, edx",
    "lea     r8d, [rbx+0x38]",
    "lea     rcx, [rsp+0x68]",
    "call    memset",
    "cmp     r15d, ebx",
    "jne     0x14009f222",
    "mov     qword [rsp+0x20], rbx",
    "lea     r9, [rsp+0xa8]",
    "lea     r8, [rel data_1400ea8a0]  {u\"system\"}",
    "mov     rdx, r12",
    "mov     ecx, r13d",
    "call    sub_140013220",
    "cmp     eax, ebx",
    "je      0x14009f403",
    "mov     qword [rsp+0x20], rbx",
    "lea     r9, [rsp+0x60]",
    "lea     r8, [rel data_140103338]  {u\"user\"}",
    "mov     rdx, r12",
    "mov     ecx, r13d",
    "call    sub_140013220",
    "cmp     eax, ebx",
    "je      0x14009f0b8",
    "mov     edx, 0x10",
    "lea     ecx, [rdx+0x30]",
    "call    qword [rel LocalAlloc]",
    "mov     rdi, rax",
    "mov     qword [rsp+0x40], rax",
    "cmp     rax, rbx",
    "je      0x14009f431",
    "mov     qword [rsp+0x30], rbx",
    "mov     dword [rsp+0x28], ebx",
    "mov     esi, 0x3",
    "mov     dword [rsp+0x20], esi",
    "xor     r9d, r9d",
    "mov     edx, 0x80000000",
    "lea     r8d, [rsi-0x2]",
    "mov     rcx, qword [rsp+0xa8]",
    "call    qword [rel CreateFileW]",
    "mov     r14, rax",
    "cmp     rax, 0xffffffffffffffff",
    "je      0x14009f3ea",
    "mov     qword [rsp+0x20], rbx",
    "lea     r9, [rsp+0x40]",
    "lea     r8, [rel data_14010d5b8]  {u\"subject\"}",
    "mov     rdx, r12",
    "mov     ecx, r13d",
    "call    sub_140013220",
    "cmp     eax, ebx",
    "je      0x14009f222",
    "lea     rcx, [rel data_14010d320]  {u\"> User cache replace mode !\\n\"}",
    "call    sub_14000c030",
    "mov     rdx, qword [rsp+0x60]",
    "lea     rcx, [rel data_14010d360]  {u\"  * user     : %s\\n\"}",
    "call    sub_14000c030",
    "mov     qword [rsp+0x20], rbx",
    "lea     r9, [rsp+0x40]",
    "lea     r8, [rel data_14010d388]",
    "mov     rdx, r12",
    "mov     ecx, r13d",
    "call    sub_140013220",
    "cmp     eax, ebx",
    "je      0x14009ef95",
    "mov     eax, ebx",
    "lea     r9, [rsp+0x40]",
    "xor     r8d, r8d",
    "xor     edx, edx",
    "xor     ecx, ecx",
    "call    sub_14000e608",
    "jmp     0x14009f433",
    "call    qword [rel GetLastError]",
    "mov     edx, eax",
    "lea     rcx, [rel data_14010d8d0]  {u\"ERROR kuhl_m_lsadump_secretsOrCa\u2026\"}",
    "call    sub_14000c030",
    "jmp     0x14009f528",
    "lea     edx, [rsi+0xd]",
    "lea     ecx, [rsi+0x3d]",
    "call    qword [rel LocalAlloc]",
    "mov     rdi, rax",
    "mov     qword [rsp+0x40], rax",
    "cmp     rax, rbx",
    "je      0x14009f2b0",
    "lea     rax, [rel data_1400f9d5c]",
    "mov     qword [rsp+0x20], rax",
    "mov     r9d, 0x1c000",
    "xor     r8d, r8d",
    "xor     edx, edx",
    "lea     ecx, [rdx+0xa]",
    "call    qword [rel CertOpenStore]",
    "mov     rsi, rax",
    "mov     qword [rsp+0x50], rax",
    "cmp     rax, rbx",
    "je      0x14009f20e",
    "mov     qword [rsp+0x20], rbx",
    "lea     r9, [rsp+0x40]",
    "lea     r8, [rel data_1400ee440]  {u\"ntlm\"}",
    "mov     rdx, r12",
    "mov     ecx, r13d",
    "call    sub_140013220",
    "cmp     eax, ebx",
    "je      0x14009f008",
    "xor     eax, eax",
    "or      rcx, 0xffffffffffffffff",
    "mov     rdi, qword [rsp+0x40]",
    "repne scasw word [rdi]",
    "not     rcx",
    "dec     rcx",
    "cmp     rcx, 0x20",
    "sete    al",
    "cmp     eax, ebx",
    "je      0x14009ef4b",
    "mov     rcx, qword [rsp+0x90]",
    "cmp     rcx, rbx",
    "je      0x14009f546",
    "lea     rax, [rsp+0x48]",
    "mov     qword [rsp+0x28], rax",
    "mov     esi, 0x20019",
    "mov     dword [rsp+0x20], esi",
    "xor     r9d, r9d",
    "lea     r8, [rel data_14010d270]  {u\"SYSTEM\"}",
    "mov     r12, 0xffffffff80000002",
    "mov     rdx, r12",
    "mov     rcx, rdi",
    "call    sub_14000e7cc",
    "cmp     eax, ebx",
    "je      0x14009f520",
    "cmp     eax, ebx",
    "je      0x14009f528",
    "mov     eax, ebx",
    "lea     r9, [rsp+0x40]",
    "xor     r8d, r8d",
    "mov     rdx, r14",
    "lea     ecx, [rsi-0x2]",
    "call    sub_14000e608",
    "jmp     0x14009f2b2",
    "call    qword [rel GetLastError]",
    "mov     edx, eax",
    "lea     rcx, [rel data_14010d7b0]  {u\"ERROR kuhl_m_lsadump_secretsOrCa\u2026\"}",
    "call    sub_14000c030",
    "mov     qword [rsp+0x28], rbx",
    "mov     rcx, qword [rsp+0x40]",
    "mov     qword [rsp+0x20], rcx",
    "mov     r9d, 0x80007",
    "xor     r8d, r8d",
    "mov     edx, 0x10001",
    "mov     rcx, rax",
    "call    qword [rel CertFindCertificateInStore]",
    "mov     rdi, rax",
    "mov     qword [rsp+0x40], rax",
    "cmp     rax, rbx",
    "je      0x14009f1ea",
    "mov     edx, dword [rsp+0x78]",
    "xor     eax, eax",
    "or      rcx, 0xffffffffffffffff",
    "mov     rdi, qword [rsp+0x40]",
    "repne scasw word [rdi]",
    "not     rcx",
    "dec     rcx",
    "mov     edx, ebx",
    "cmp     rcx, 0x20",
    "sete    dl",
    "cmp     edx, ebx",
    "je      0x14009efee",
    "mov     dword [rsp+0x8c], eax",
    "cmp     eax, ebx",
    "je      0x14009ef84",
    "mov     r9d, eax",
    "lea     r8d, [rbx+0x10]",
    "lea     rdx, [rsp+0x7c]",
    "mov     rcx, qword [rsp+0x40]",
    "call    sub_140012e68",
    "xor     eax, eax",
    "add     rsp, 0xe0",
    "pop     r15",
    "pop     r14",
    "pop     r13",
    "pop     r12",
    "pop     rdi",
    "pop     rsi",
    "pop     rbx",
    "retn    ",
    "cmp     dword [rsp+0x138], ebx",
    "je      0x14009f546",
    "mov     rcx, rdi",
    "call    sub_14000e770",
    "lea     r8, [rsp+0xb8]",
    "mov     rdx, qword [rsp+0x48]",
    "mov     rcx, rdi",
    "call    sub_14009f7f0",
    "cmp     eax, ebx",
    "je      0x14009f513",
    "mov     rcx, r14",
    "call    qword [rel CloseHandle]",
    "jmp     0x14009f528",
    "lea     r8, [rsp+0xb8]",
    "xor     edx, edx",
    "mov     rcx, rdi",
    "call    sub_14009f7f0",
    "cmp     eax, ebx",
    "je      0x14009f3d4",
    "cmp     eax, ebx",
    "je      0x14009f3dc",
    "call    qword [rel GetLastError]",
    "mov     edx, eax",
    "lea     rcx, [rel data_14010d710]  {u\"ERROR kuhl_m_lsadump_secretsOrCa\u2026\"}",
    "call    sub_14000c030",
    "lea     rax, [rsp+0x138]",
    "mov     qword [rsp+0x28], rax",
    "lea     rax, [rsp+0x98]",
    "mov     qword [rsp+0x20], rax",
    "lea     r9, [rsp+0x90]",
    "xor     r8d, r8d",
    "xor     edx, edx",
    "mov     rcx, rdi",
    "call    qword [rel CryptAcquireCertificatePrivateKey]",
    "cmp     eax, ebx",
    "je      0x14009f1df",
    "cmp     edx, ebx",
    "je      0x14009f0a2",
    "lea     rax, [rel data_1400e5b78]  {u\"mimikatz\"}",
    "mov     qword [rsp+0x20], rax",
    "lea     r9, [rsp+0x40]",
    "lea     r8, [rel data_1400fc488]  {u\"password\"}",
    "mov     rdx, r12",
    "mov     ecx, r13d",
    "call    sub_140013220",
    "mov     rdx, qword [rsp+0x40]",
    "lea     rcx, [rel data_14010d570]  {u\"  * password : %s\\n\"}",
    "call    sub_14000c030",
    "mov     rdx, qword [rsp+0x40]",
    "lea     rcx, [rsp+0xc8]",
    "call    RtlInitUnicodeString",
    "lea     rdx, [rsp+0x68]",
    "lea     rcx, [rsp+0xc8]",
    "call    SystemFunction007",
    "mov     edx, ebx",
    "cmp     eax, ebx",
    "setge   dl",
    "mov     dword [rsp+0x78], edx",
    "mov     dword [rsp+0x78], edx",
    "cmp     edx, ebx",
    "jne     0x14009f00c",
    "mov     r9d, edx",
    "lea     r8d, [rax+0x10]",
    "lea     rdx, [rsp+0x68]",
    "mov     rcx, qword [rsp+0x40]",
    "call    sub_140012e68",
    "mov     edx, eax",
    "lea     rcx, [rel data_14010d3b0]  {u\"ERROR kuhl_m_lsadump_secretsOrCa\u2026\"}",
    "call    sub_14000c030",
    "jmp     0x14009f0a7",
    "lea     rcx, [rel data_14010d390]  {u\"  * dccX     : \"}",
    "call    sub_14000c030",
    "xor     r8d, r8d",
    "lea     edx, [r8+0x10]",
    "lea     rcx, [rsp+0x7c]",
    "call    sub_140012f68",
    "lea     rcx, [rel data_1400d27a8]",
    "call    sub_14000c030",
    "jmp     0x14009f0a7",
    "xor     edx, edx",
    "call    qword [rel CryptReleaseContext]",
    "mov     rdx, qword [rsp+0x48]",
    "mov     rcx, rdi",
    "call    sub_14000f310",
    "lea     rax, [rsp+0xa0]",
    "mov     qword [rsp+0x28], rax",
    "mov     dword [rsp+0x20], esi",
    "xor     r9d, r9d",
    "lea     r8, [rel data_14010d968]  {u\"SECURITY\"}",
    "mov     rdx, r12",
    "mov     rcx, rdi",
    "call    sub_14000e7cc",
    "cmp     eax, ebx",
    "je      0x14009f4ff",
    "mov     rcx, rdi",
    "call    sub_14000e770",
    "mov     qword [rsp+0x20], rbx",
    "lea     r9, [rsp+0xb0]",
    "lea     r8, [rel data_14010d128]  {u\"security\"}",
    "mov     rdx, r12",
    "mov     ecx, r13d",
    "call    sub_140013220",
    "cmp     eax, ebx",
    "je      0x14009f3d4",
    "mov     rcx, rdi",
    "call    qword [rel CertFreeCertificateContext]",
    "jmp     0x14009f1fe",
    "cmp     dword [rsp+0x98], 0xffffffff",
    "jne     0x14009f1df",
    "mov     qword [rsp+0x60], rbx",
    "lea     rcx, [rel data_14010d598]  {u\"  * ntlm     : \"}",
    "call    sub_14000c030",
    "xor     r8d, r8d",
    "lea     edx, [r8+0x10]",
    "lea     rcx, [rsp+0x68]",
    "call    sub_140012f68",
    "lea     rcx, [rel data_1400d27a8]",
    "call    sub_14000c030",
    "jmp     0x14009f0a7",
    "cmp     edx, ebx",
    "jne     0x14009f073",
    "lea     rcx, [rel data_14010d490]  {u\"ERROR kuhl_m_lsadump_secretsOrCa\u2026\"}",
    "call    sub_14000c030",
    "mov     edx, dword [rsp+0x78]",
    "jmp     0x14009f00c",
    "lea     rcx, [rel data_1400d27a8]",
    "call    sub_14000c030",
    "jmp     0x14009f222",
    "call    qword [rel GetLastError]",
    "mov     edx, eax",
    "lea     rcx, [rel data_14010d980]  {u\"ERROR kuhl_m_lsadump_secretsOrCa\u2026\"}",
    "call    sub_14000c030",
    "lea     rax, [rsp+0x60]",
    "mov     qword [rsp+0x30], rax",
    "mov     dword [rsp+0x28], r15d",
    "lea     rax, [rsp+0xb8]",
    "mov     qword [rsp+0x20], rax",
    "mov     r9, qword [rsp+0x48]",
    "mov     r8, rdi",
    "mov     rdx, qword [rsp+0xa0]",
    "mov     rcx, rdi",
    "call    sub_1400a05dc",
    "mov     rdx, qword [rsp+0xa0]",
    "mov     rcx, rdi",
    "call    sub_14000f310",
    "jmp     0x14009f513",
    "mov     rax, qword [rsp+0x60]",
    "neg     rax",
    "sbb     edx, edx",
    "and     edx, 0x40000000",
    "bts     edx, 0x1f",
    "mov     qword [rsp+0x30], rbx",
    "mov     dword [rsp+0x28], ebx",
    "mov     dword [rsp+0x20], esi",
    "xor     r9d, r9d",
    "xor     r8d, r8d",
    "mov     rcx, qword [rsp+0xb0]",
    "call    qword [rel CreateFileW]",
    "mov     r12, rax",
    "cmp     rax, 0xffffffffffffffff",
    "je      0x14009f3c0",
    "mov     edx, 0x1",
    "mov     rcx, rsi",
    "call    qword [rel CertCloseStore]",
    "jmp     0x14009f222",
    "lea     rcx, [rel data_14010d5d0]  {u\"ERROR kuhl_m_lsadump_secretsOrCa\u2026\"}",
    "call    sub_14000c030",
    "nop     ",
    "cmp     dword [rsp+0x138], ebx",
    "je      0x14009f1a5",
    "call    qword [rel GetLastError]",
    "mov     edx, eax",
    "lea     rcx, [rel data_14010d830]  {u\"ERROR kuhl_m_lsadump_secretsOrCa\u2026\"}",
    "call    sub_14000c030",
    "mov     r13d, ebx",
    "cmp     qword [rsp+0x60], rbx",
    "setne   r13b",
    "mov     edx, 0x10",
    "lea     ecx, [rdx+0x30]",
    "call    qword [rel LocalAlloc]",
    "mov     rsi, rax",
    "mov     qword [rsp+0x50], rax",
    "cmp     rax, rbx",
    "je      0x14009f37b",
    "jmp     0x14009f1d7",
    "mov     rcx, qword [rsp+0x90]",
    "call    NCryptFreeObject",
    "mov     eax, ebx",
    "lea     r9, [rsp+0x50]",
    "mov     r8d, r13d",
    "mov     rdx, r12",
    "mov     ecx, 0x1",
    "call    sub_14000e608",
    "jmp     0x14009f37d",
    "mov     qword [rsp+0x90], rbx",
    "mov     rcx, r12",
    "call    qword [rel CloseHandle]",
    "jmp     0x14009f3d4",
    "lea     rax, [rsp+0x60]",
    "mov     qword [rsp+0x30], rax",
    "mov     dword [rsp+0x28], r15d",
    "lea     rax, [rsp+0xb8]",
    "mov     qword [rsp+0x20], rax",
    "xor     r9d, r9d",
    "mov     r8, rdi",
    "xor     edx, edx",
    "mov     rcx, rsi",
    "call    sub_1400a05dc",
    "mov     rcx, rsi",
    "call    sub_14000e770",
    "cmp     eax, ebx",
    "je      0x14009f3b5"
  ],
  "high_level_IL": [
    "No High Level IL Loaded"
  ]
}