{
  "address": "0x1400aab5c",
  "rules": [
    "hash data using djb2/1485ed9954f84e3481d22b64bc4cfca7",
    "check for time delay via GetTickCount/dcdc41ab318e4e618f624ba5aeac30b2",
    "validate payment card number using luhn algorithm with no lookup table/f595b07566ee46b3ba7870816078c34e",
    "contain loop",
    "hash data using jshash/79354a2ef36a4036b42806ea4b41f8bd",
    "encrypt data using chaskey/4b6f9d91d05f46dd9aa3662f80cb6278",
    "write file on Windows/035d57bed47747649158312e9532f27d"
  ],
  "disassembly": [
    "mov     qword [rsp+0x8 {__saved_rbx}], rbx",
    "push    rbp {__saved_rbp}",
    "push    rsi {__saved_rsi}",
    "push    rdi {__saved_rdi}",
    "push    r12 {__saved_r12}",
    "push    r13 {__saved_r13}",
    "push    r14 {__saved_r14}",
    "push    r15 {__saved_r15}",
    "sub     rsp, 0x180",
    "lea     r8, [rel data_1400d5340]",
    "lea     rcx, [rsp+0x50 {hObject}]",
    "mov     edx, 0x3",
    "call    NtOpenDirectoryObject",
    "xor     r15d, r15d  {0x0}",
    "cmp     eax, r15d",
    "jl      0x1400aae1c",
    "lea     rcx, [rel data_140117420]  {u\"ERROR kuhl_m_misc_shadowcopies ;\u2026\"}",
    "mov     edx, eax",
    "call    sub_14000c030",
    "mov     r13d, r15d  {0x0}",
    "mov     dword [rsp+0x1d0 {arg_18}], r15d  {0x0}",
    "mov     bl, 0x1",
    "lea     rcx, [rel data_140117390]  {u\"ERROR kuhl_m_misc_shadowcopies ;\u2026\"}",
    "mov     edx, eax",
    "call    sub_14000c030",
    "mov     edx, dword [rsp+0x1d0 {arg_18}]",
    "mov     ebp, r15d  {0x0}",
    "cmp     edx, r13d",
    "je      0x1400aadec",
    "mov     rcx, qword [rsp+0x50 {hObject}]",
    "lea     rax, [rsp+0x1d8 {arg_20}]",
    "lea     rdx, [rsp+0x80 {var_138}]",
    "mov     qword [rsp+0x30 {var_188_1}], rax {arg_20}",
    "lea     rax, [rsp+0x1d0 {arg_18}]",
    "xor     r9d, r9d  {0x0}",
    "mov     qword [rsp+0x28 {var_190_1}], rax {arg_18}",
    "mov     r8d, 0x100",
    "mov     byte [rsp+0x20 {var_198_1}], bl",
    "call    NtQueryDirectoryObject",
    "cmp     eax, r15d",
    "mov     r14d, eax",
    "jl      0x1400aadf4",
    "mov     rcx, qword [rsp+0x50 {hObject}]",
    "call    qword [rel CloseHandle]",
    "jmp     0x1400aae2a",
    "mov     r13d, edx",
    "mov     bl, r15b  {0x0}",
    "jmp     0x1400aae02",
    "lea     rbx, [rsp+0x80 {var_138}]",
    "xor     eax, eax  {0x0}",
    "mov     rbx, qword [rsp+0x1c0 {__saved_rbx}]",
    "add     rsp, 0x180",
    "pop     r15 {__saved_r15}",
    "pop     r14 {__saved_r14}",
    "pop     r13 {__saved_r13}",
    "pop     r12 {__saved_r12}",
    "pop     rdi {__saved_rdi}",
    "pop     rsi {__saved_rsi}",
    "pop     rbp {__saved_rbp}",
    "retn     {__return_addr}",
    "cmp     r14d, 0x105",
    "je      0x1400aaba2",
    "mov     edx, dword [rsp+0x1d0 {arg_18}]",
    "inc     ebp",
    "add     rbx, 0x20",
    "mov     eax, edx",
    "sub     eax, r13d",
    "cmp     ebp, eax",
    "jb      0x1400aac02",
    "cmp     word [rbx], r15w",
    "je      0x1400aadd2",
    "mov     ecx, ebp",
    "mov     r8b, 0x1",
    "shl     rcx, 0x5",
    "lea     rdx, [rsp+rcx+0x90] {var_1b8}",
    "lea     rcx, [rel data_1400d5330]",
    "call    RtlEqualUnicodeString",
    "cmp     al, r15b",
    "je      0x1400aadd2",
    "cmp     qword [rbx+0x8], r15",
    "je      0x1400aadd2",
    "movzx   edx, word [rbx]",
    "mov     ecx, 0x40",
    "add     rdx, 0x2",
    "call    qword [rel LocalAlloc]",
    "mov     r12, rax",
    "cmp     rax, r15",
    "je      0x1400aadd2",
    "movzx   r8d, word [rbx]",
    "mov     rdx, qword [rbx+0x8]",
    "mov     rcx, rax",
    "call    memcpy",
    "lea     rdx, [rel data_140117188]  {u\"HarddiskVolumeShadowCopy\"}",
    "mov     rcx, r12",
    "call    qword [rel wcsstr]",
    "cmp     r12, rax",
    "jne     0x1400aadc9",
    "mov     rcx, r12",
    "call    qword [rel LocalFree]",
    "lea     rdx, [rel data_1401171c0]  {u\"\\\\?\\GLOBALROOT\\Device\\%s\\\"}",
    "lea     rcx, [rsp+0x40 {var_178}]",
    "mov     r8, r12",
    "call    sub_140013b1c",
    "cmp     eax, r15d",
    "je      0x1400aadc9",
    "lea     rcx, [rel data_1401171f8]  {u\"\\nShadowCopy Volume : %s\\n\"}",
    "mov     rdx, r12",
    "call    sub_14000c030",
    "mov     rdx, qword [rsp+0x40 {var_178}]",
    "lea     rcx, [rel data_140117230]  {u\"| Path            : %s\\n\"}",
    "call    sub_14000c030",
    "mov     rcx, qword [rsp+0x40 {var_178}]",
    "lea     r8, [rsp+0x58 {lpFileInformation}]",
    "xor     edx, edx  {0x0}",
    "call    qword [rel GetFileAttributesExW]",
    "cmp     eax, r15d",
    "je      0x1400aacfb",
    "call    qword [rel GetLastError]",
    "lea     rcx, [rel data_140117290]  {u\"ERROR kuhl_m_misc_shadowcopies ;\u2026\"}",
    "mov     edx, eax",
    "call    sub_14000c030",
    "lea     rcx, [rel data_140117260]  {u\"| Volume LastWrite: \"}",
    "call    sub_14000c030",
    "lea     rcx, [rsp+0x6c {var_14c}]",
    "call    sub_1400130c0",
    "lea     rcx, [rel data_1400d27a8]",
    "call    sub_14000c030",
    "jmp     0x1400aad0f",
    "add     rdi, 0x8",
    "sub     rsi, 0x1",
    "jne     0x1400aad27",
    "mov     rdx, qword [rsp+0x48 {var_170}]",
    "lea     rcx, [rel data_140117350]  {u\"* %s\\n\"}",
    "call    sub_14000c030",
    "mov     rcx, qword [rsp+0x48 {var_170}]",
    "lea     r8, [rsp+0x58 {lpFileInformation}]",
    "xor     edx, edx  {0x0}",
    "call    qword [rel GetFileAttributesExW]",
    "cmp     eax, r15d",
    "je      0x1400aad91",
    "lea     rcx, [rel data_1400d27a8]",
    "call    sub_14000c030",
    "lea     rdi, [rel data_14013bff0]",
    "mov     esi, 0x4",
    "mov     r9, qword [rdi]",
    "mov     r8, qword [rsp+0x40 {var_178}]",
    "lea     rdx, [rel data_140117310]  {u\"%sWindows\\System32\\config\\%s\"}",
    "lea     rcx, [rsp+0x48 {var_170}]",
    "call    sub_140013b1c",
    "cmp     eax, r15d",
    "je      0x1400aadb0",
    "mov     rcx, qword [rsp+0x40 {var_178}]",
    "call    qword [rel LocalFree]",
    "call    qword [rel GetLastError]",
    "lea     rcx, [rel data_140117290]  {u\"ERROR kuhl_m_misc_shadowcopies ;\u2026\"}",
    "mov     edx, eax",
    "call    sub_14000c030",
    "lea     rcx, [rel data_140117360]  {u\"  | LastWrite   : \"}",
    "call    sub_14000c030",
    "lea     rcx, [rsp+0x6c {var_14c}]",
    "call    sub_1400130c0",
    "lea     rcx, [rel data_1400d27a8]",
    "call    sub_14000c030",
    "jmp     0x1400aada5",
    "mov     rcx, qword [rsp+0x48 {var_170}]",
    "call    qword [rel LocalFree]"
  ],
  "high_level_IL": [
    "HANDLE hObject",
    "int32_t rax = NtOpenDirectoryObject(&hObject, 3, &data_1400d5340)",
    "if (rax s< 0)",
    "sub_14000c030(u\"ERROR kuhl_m_misc_shadowcopies ;\u2026\", zx.q(rax))",
    "int32_t r13_1 = 0",
    "arg_18 = 0",
    "void* rbx",
    "rbx.b = 1",
    "int32_t i",
    "void var_138",
    "i = NtQueryDirectoryObject(hObject, &var_138, 0x100, 0, rbx.b, &arg_18, &arg_20)",
    "if (i s< 0)",
    "sub_14000c030(u\"ERROR kuhl_m_misc_shadowcopies ;\u2026\", zx.q(i))",
    "int32_t rdx_2 = arg_18",
    "int32_t j = 0",
    "if (rdx_2 != r13_1)",
    "rbx = &var_138",
    "void var_1b8",
    "if (RtlEqualUnicodeString(&data_1400d5330, &var_1b8 + (zx.q(j) << 5) + 0x90, 1) != 0 && *rbx != 0 && *(rbx + 8) != 0)",
    "HLOCAL rax_2 = LocalAlloc(LMEM_ZEROINIT, zx.q(*rbx) + 2)",
    "if (rax_2 != 0)",
    "memcpy(rax_2, *(rbx + 8), zx.q(*rbx))",
    "void* var_178",
    "if (rax_2 == wcsstr(rax_2, u\"HarddiskVolumeShadowCopy\") && sub_140013b1c(&var_178, u\"\\\\?\\GLOBALROOT\\Device\\%s\\\", rax_2) != 0)",
    "sub_14000c030(u\"\\nShadowCopy Volume : %s\\n\", rax_2)",
    "sub_14000c030(u\"| Path            : %s\\n\", var_178)",
    "void lpFileInformation",
    "BOOL rax_5",
    "int64_t rdx_9",
    "rax_5, rdx_9 = GetFileAttributesExW(var_178, GetFileExInfoStandard, &lpFileInformation)",
    "void var_14c",
    "int64_t rdx_11",
    "if (rax_5 == 0)",
    "rdx_11 = sub_14000c030(u\"ERROR kuhl_m_misc_shadowcopies ;\u2026\", zx.q(GetLastError()))",
    "sub_14000c030(u\"| Volume LastWrite: \", rdx_9)",
    "rdx_11 = sub_14000c030(U\"\\n\", sub_1400130c0(&var_14c))",
    "sub_14000c030(U\"\\n\", rdx_11)",
    "wchar16 const (** rdi_1)[0x7] = &data_14013bff0",
    "int64_t k_1 = 4",
    "int64_t k",
    "*rdi_1",
    "void* var_170",
    "if (sub_140013b1c(&var_170, u\"%sWindows\\System32\\config\\%s\", var_178) != 0)",
    "sub_14000c030(u\"* %s\\n\", var_170)",
    "BOOL rax_8",
    "int64_t rdx_14",
    "rax_8, rdx_14 = GetFileAttributesExW(var_170, GetFileExInfoStandard, &lpFileInformation)",
    "if (rax_8 == 0)",
    "sub_14000c030(u\"ERROR kuhl_m_misc_shadowcopies ;\u2026\", zx.q(GetLastError()))",
    "sub_14000c030(u\"  | LastWrite   : \", rdx_14)",
    "sub_14000c030(U\"\\n\", sub_1400130c0(&var_14c))",
    "LocalFree(var_170)",
    "rdi_1 = &rdi_1[1]",
    "k = k_1",
    "k_1 -= 1",
    "do while (k != 1)",
    "LocalFree(var_178)",
    "LocalFree(rax_2)",
    "rdx_2 = arg_18",
    "j += 1",
    "rbx += 0x20",
    "do while (j u< rdx_2 - r13_1)",
    "r13_1 = rdx_2",
    "rbx.b = 0",
    "do while (i == 0x105)",
    "CloseHandle(hObject)",
    "return 0"
  ]
}